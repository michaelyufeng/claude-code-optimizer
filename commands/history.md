---
description: View project session history and evolution timeline
---

# 会话历史 (Memory System)

## 功能说明

查看项目的完整会话历史、阶段演进、决策记录和变更时间线。

## 历史视图

### 1. 时间线视图

```
📅 项目时间线

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
                        项目演进历史
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

2024-12-14 10:00  🆕 项目初始化
        │         ├─ 项目类型: 全新项目
        │         └─ 开始研究阶段
        │
        ▼
2024-12-14 14:30  📊 完成市场调研
        │         ├─ 确定目标用户群
        │         └─ 分析竞争格局
        │
        ▼
2024-12-14 18:00  ⚙️ 完成技术研究
        │         ├─ 选定技术栈: Hono + Drizzle
        │         └─ 💾 检查点: cp_20241214_180033
        │
        ▼
2024-12-15 09:00  ✅ 研究阶段完成
        │         ├─ 6项研究全部完成
        │         └─ 进入规划阶段
        │
        ▼
2024-12-15 12:00  📝 完成 PRD
        │         ├─ 定义核心功能
        │         ├─ 确定 MVP 范围
        │         └─ 💾 检查点: cp_20241215_120015
        │
        ▼
2024-12-15 12:30  🚧 Gate1 审核通过
        │         ├─ PRD 完整性: ✓
        │         ├─ 技术可行性: ✓
        │         └─ 进入架构阶段
        │
        ▼
2024-12-15 14:30  🏗️ 架构设计中
        │         ├─ 完成系统架构
        │         ├─ 开始 API 设计
        │         ├─ 🔑 决策: 使用 JWT 认证
        │         └─ 💾 检查点: cp_20241215_143022 ← 当前
        │
        ▼
        ○ 原型阶段 (待开始)
        ○ Gate2 (待开始)
        ○ 后端阶段 (待开始)
        ○ 集成阶段 (待开始)
        ○ 输出阶段 (待开始)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 2. 会话列表

```
📋 会话历史

| # | 日期 | 时长 | 阶段 | 工作内容 | 检查点 |
|---|------|------|------|----------|--------|
| 5 | 12-15 13:00-14:30 | 1.5h | 架构 | API设计、认证方案 | cp_...3022 |
| 4 | 12-15 11:00-12:30 | 1.5h | 规划→Gate1 | PRD完成、审核通过 | cp_...0015 |
| 3 | 12-15 09:00-10:30 | 1.5h | 研究 | 成本和竞品分析 | - |
| 2 | 12-14 14:00-18:00 | 4h | 研究 | 市场和技术研究 | cp_...0033 |
| 1 | 12-14 10:00-11:00 | 1h | 初始化 | 项目创建 | - |

总计: 5 个会话, 9.5 小时
```

### 3. 阶段统计

```
📊 阶段完成统计

阶段          状态      耗时      会话数    检查点
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
研究          ✅ 完成    5.5h      3         1
规划          ✅ 完成    1h        1         1
Gate1         ✅ 通过    0.5h      1         -
架构          🔄 进行中  1.5h      1         1
原型          ⏳ 待开始  -         -         -
Gate2         ⏳ 待开始  -         -         -
后端          ⏳ 待开始  -         -         -
集成          ⏳ 待开始  -         -         -
输出          ⏳ 待开始  -         -         -
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
总计                    8.5h      5         3
```

---

## 详细视图

### 会话详情

```markdown
## 会话详情

/project-optimizer:history --session 5

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 会话 #5 详情
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📅 时间: 2024-12-15 13:00 - 14:30
⏱️ 时长: 1.5 小时
📍 阶段: 架构阶段

### 工作内容
1. 完成系统架构设计
2. 开始 API 端点设计
3. 确定认证方案

### 完成的任务
- [x] 设计整体架构图
- [x] 定义 API 规范
- [ ] 设计用户认证 API (40%)

### 关键决策
- 🔑 使用 JWT 进行认证
  - 理由: 支持无状态验证，适合微服务架构

### 修改的文件
- docs/ARCHITECTURE.md (新建)
- docs/API.md (修改)

### 待解决问题
- 是否需要支持 OAuth2.0？
- Token 过期时间设置多长？

### 检查点
- 💾 cp_20241215_143022 (会话结束时保存)
```

### 决策历史

```markdown
## 决策历史

/project-optimizer:history --decisions

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔑 关键决策记录
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

### 技术决策

| # | 决策 | 理由 | 阶段 | 日期 |
|---|------|------|------|------|
| 1 | 使用 TypeScript | 类型安全，减少 bug | 研究 | 12-14 |
| 2 | 选择 Hono 框架 | 轻量、快速、边缘友好 | 研究 | 12-14 |
| 3 | 使用 Drizzle ORM | 类型安全、性能好 | 研究 | 12-14 |
| 4 | JWT 认证 | 无状态验证 | 架构 | 12-15 |

### 产品决策

| # | 决策 | 理由 | 阶段 | 日期 |
|---|------|------|------|------|
| 1 | MVP 专注核心功能 | 快速验证市场 | 规划 | 12-15 |
| 2 | 移动端优先 | 目标用户习惯 | 规划 | 12-15 |

### 架构决策

| # | 决策 | 理由 | 阶段 | 日期 |
|---|------|------|------|------|
| 1 | 单体优先 | 初期简单，后期可拆分 | 架构 | 12-15 |
| 2 | REST API | 简单直接，工具支持好 | 架构 | 12-15 |
```

### 文件变更历史

```markdown
## 文件变更历史

/project-optimizer:history --files

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📁 文件变更记录
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

### docs/API.md
| 版本 | 时间 | 变更 | 会话 |
|------|------|------|------|
| v3 | 12-15 14:30 | 添加认证端点 | #5 |
| v2 | 12-15 14:00 | 添加用户端点 | #5 |
| v1 | 12-15 13:30 | 初始创建 | #5 |

### docs/ARCHITECTURE.md
| 版本 | 时间 | 变更 | 会话 |
|------|------|------|------|
| v1 | 12-15 13:15 | 初始创建 | #5 |

### docs/PRD.md
| 版本 | 时间 | 变更 | 会话 |
|------|------|------|------|
| v2 | 12-15 12:00 | 完善 MVP 范围 | #4 |
| v1 | 12-15 11:30 | 初始创建 | #4 |
```

---

## 搜索和过滤

### 命令选项

```markdown
## 历史搜索

### 按时间范围
/project-optimizer:history --from 2024-12-14 --to 2024-12-15

### 按阶段
/project-optimizer:history --phase architecture

### 按关键词
/project-optimizer:history --search "认证"

### 仅显示决策
/project-optimizer:history --decisions

### 仅显示检查点
/project-optimizer:history --checkpoints

### 导出历史
/project-optimizer:history --export markdown > history.md
/project-optimizer:history --export json > history.json
```

---

## 输出格式

### 简洁模式

```
/project-optimizer:history --brief

📅 项目概览: 5 个会话, 8.5 小时, 4 个阶段完成
最近: 2024-12-15 14:30 架构阶段 (65%)
```

### 完整模式

```
/project-optimizer:history --full

[显示完整的时间线、会话、决策、文件变更等所有信息]
```

---

## 历史分析

### 进度分析

```markdown
## 进度分析

/project-optimizer:history --analyze

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📈 项目进度分析
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

### 完成进度
整体进度: ████████░░░░░░░░░░░░ 40%
当前阶段: 架构 (4/9)

### 效率分析
- 平均每阶段: 2.1 小时
- 最快阶段: Gate1 (0.5h)
- 最慢阶段: 研究 (5.5h)

### 会话模式
- 平均会话时长: 1.7 小时
- 最活跃时间: 下午
- 平均每天会话: 2.5 个

### 决策频率
- 总决策数: 8 个
- 技术决策: 4 个
- 产品决策: 2 个
- 架构决策: 2 个

### 检查点覆盖
- 总检查点: 3 个
- 检查点频率: 每 2.8 小时
- 最近检查点: 2 小时前
```
