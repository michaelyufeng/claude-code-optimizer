---
description: Assess CLAUDE.md quality and provide improvement suggestions
---

# CLAUDE.md 质量评估

独立的评估命令，可单独运行来检查 CLAUDE.md 质量。

## 命令用法

```bash
/project-optimizer:assess                  # 评估当前项目的 CLAUDE.md
/project-optimizer:assess --detailed       # 详细评估报告
/project-optimizer:assess --fix            # 评估并自动修复问题
/project-optimizer:assess --compare [file] # 与另一个 CLAUDE.md 比较
```

---

## 评估维度

### 📋 完整性 (25%)

检查是否包含必要章节：

| 章节 | 分值 | 检测关键词 |
|------|------|-----------|
| 项目概述 | 2 | `# `, `## 概述`, `## 简介`, `## About` |
| 技术栈 | 2 | `## 技术`, `## Tech`, `Stack`, `框架` |
| 代码规范 | 2 | `## 规范`, `## 风格`, `Style`, `Convention` |
| 命令说明 | 2 | `## 命令`, `## Command`, `npm`, `pnpm`, `yarn` |
| 目录结构 | 2 | `## 结构`, `## Structure`, `├──`, `└──` |

### ✂️ 简洁性 (20%)

| 行数范围 | 分值 | 评价 |
|----------|------|------|
| 50-100 行 | 10 | 最佳 |
| 100-200 行 | 8 | 良好 |
| 200-300 行 | 5 | 偏长 |
| 300+ 行 | 2 | 过长，需精简 |
| <50 行 | 3 | 过短，可能不完整 |

额外检查：
- 是否有重复内容 (-2)
- 是否有过长的代码块 (>50行 -1)
- 是否有不必要的注释 (-1)

### 🎯 实用性 (25%)

| 检查项 | 分值 | 说明 |
|--------|------|------|
| 可执行命令 | 3 | 有 `npm run`, `pnpm`, 具体脚本 |
| 具体规范 | 3 | 非泛泛而谈，有具体要求 |
| 规则分级 | 2 | 有 MUST/SHOULD/PREFER 或类似分级 |
| 示例代码 | 2 | 有代码示例或模板 |

### 📐 规范性 (15%)

| 检查项 | 分值 | 说明 |
|--------|------|------|
| 版本/时间 | 3 | 有版本号或更新时间 |
| 标准结构 | 3 | 使用 Markdown 标题层级 |
| 作者信息 | 2 | 有作者/团队/维护者 |
| 格式美观 | 2 | 表格、列表使用得当 |

### 🔄 演进性 (15%)

| 检查项 | 分值 | 说明 |
|--------|------|------|
| 状态追踪 | 4 | 有项目阶段/进度说明 |
| 变更历史 | 3 | 有 changelog 或更新记录 |
| 可更新结构 | 3 | 结构支持持续添加内容 |

---

## 评估输出

### 标准报告

```
📊 CLAUDE.md 质量评估报告

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📁 文件信息
   路径: ./CLAUDE.md
   行数: 178 行
   大小: 5.2 KB
   最后修改: 2024-12-22 14:30

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📈 维度评分

   完整性 (25%)   ████████░░  80%  (8/10)
   简洁性 (20%)   ███████░░░  70%  (7/10)
   实用性 (25%)   █████████░  90%  (9/10)
   规范性 (15%)   ██████░░░░  60%  (6/10)
   演进性 (15%)   ████░░░░░░  40%  (4/10)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📊 综合评分: 72/100

🏷️ 评级: ⭐⭐⭐ 良好

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 做得好的地方:
   • 技术栈说明清晰完整
   • 命令文档实用可执行
   • 有规则优先级分级

❌ 需要改进:
   • 缺少目录结构说明
   • 无版本号和更新时间
   • 缺少变更历史记录

💡 优化建议:
   1. 添加 ## 目录结构 章节
   2. 在文件头部添加版本信息
   3. 添加 <!-- 更新记录 --> 注释块

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔧 快速修复:
   运行 /project-optimizer:assess --fix 自动修复以上问题
```

### 详细报告 (--detailed)

```
📊 CLAUDE.md 详细评估报告

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 📋 完整性分析 (8/10)

✅ 已包含:
   L1-15   : 项目概述 (+2)
   L17-35  : 技术栈说明 (+2)
   L37-80  : 代码规范 (+2)
   L82-110 : 命令说明 (+2)

❌ 缺失:
   • 目录结构说明 (-2)

建议添加:
```markdown
## 目录结构

\`\`\`
src/
├── components/   # UI 组件
├── services/     # 业务逻辑
├── utils/        # 工具函数
└── types/        # 类型定义
\`\`\`
```

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## ✂️ 简洁性分析 (7/10)

📏 行数: 178 行 (合理范围)

⚠️ 发现问题:
   L45-75  : 代码规范章节过长 (30行)
             建议精简或拆分到单独文件
   L90-95  : 重复的命令说明
             建议合并相似内容

优化建议:
   • 将详细代码规范移到 docs/CODE_STYLE.md
   • 在 CLAUDE.md 中只保留摘要和链接

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 🎯 实用性分析 (9/10)

✅ 优秀:
   • L85: npm run dev, npm run build (+3)
   • L50: "函数不超过 50 行" - 具体可执行 (+3)
   • L60: MUST/SHOULD 规则分级 (+2)

💡 可增强:
   • 添加更多代码示例 (+1)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 📐 规范性分析 (6/10)

❌ 缺失:
   • 无版本号 (-3)
   • 无作者信息 (-2)

✅ 已有:
   • 标准 Markdown 结构 (+3)
   • 格式美观 (+2)

建议在文件头添加:
```markdown
---
version: 1.0.0
updated: 2024-12-23
author: Team Name
---
```

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 🔄 演进性分析 (4/10)

❌ 严重缺失:
   • 无项目状态追踪
   • 无变更历史
   • 结构不支持增量更新

建议添加:
```markdown
## 项目状态

当前阶段: 开发中
最后更新: 2024-12-23

## 变更记录

- 2024-12-23: 初始版本
```

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 📝 完整优化清单

| 优先级 | 问题 | 位置 | 修复方式 |
|--------|------|------|----------|
| P0 | 缺少目录结构 | - | 添加新章节 |
| P1 | 无版本信息 | 文件头 | 添加 YAML frontmatter |
| P1 | 无变更历史 | 文件尾 | 添加 changelog |
| P2 | 代码规范过长 | L45-75 | 精简或外链 |
| P2 | 重复命令说明 | L90-95 | 合并 |
```

---

## 自动修复 (--fix)

```
🔧 CLAUDE.md 自动修复

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 将执行以下修复:

[1] ✅ 添加版本信息 (P1)
    在文件头添加:
    ---
    version: 1.0.0
    updated: 2024-12-23
    ---

[2] ✅ 添加目录结构章节 (P0)
    基于项目实际结构自动生成

[3] ✅ 添加变更记录 (P1)
    在文件尾添加 changelog 模板

[4] ⏭️ 跳过: 代码规范精简 (P2)
    需要人工判断，无法自动处理

[5] ✅ 添加审查标签
    记录本次评估信息

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💾 备份: .claude/backups/CLAUDE.md.bak.20241223

确认执行？
[1] ✅ 全部执行
[2] 📝 逐项确认
[3] ❌ 取消
```

---

## 比较功能 (--compare)

```bash
/project-optimizer:assess --compare templates/CLAUDE.production.md
```

输出：

```
📊 CLAUDE.md 对比分析

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

              当前文件          参考模板
文件        ./CLAUDE.md    templates/CLAUDE.production.md
行数           178                 150
评分          72/100              95/100

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 维度对比

              当前    参考    差距
完整性        80%     100%   -20%
简洁性        70%     90%    -20%
实用性        90%     95%    -5%
规范性        60%     100%   -40%
演进性        40%     90%    -50%

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 参考模板优势

✅ 有完整的版本信息头
✅ 有标准的项目状态章节
✅ 有详细的变更记录
✅ 有清晰的红线规则

## 建议采纳

1. 复制版本信息格式
2. 添加项目状态章节
3. 参考红线规则写法

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔧 一键采纳最佳实践:
   /project-optimizer:assess --fix --reference templates/CLAUDE.production.md
```

---

## 评估历史

评估结果会保存到 `.claude/PROJECT_MEMORY/assessments/`:

```json
{
  "file": "./CLAUDE.md",
  "timestamp": "2024-12-23T14:30:00Z",
  "score": 72,
  "grade": "⭐⭐⭐",
  "dimensions": {
    "completeness": 8,
    "conciseness": 7,
    "practicality": 9,
    "standardization": 6,
    "evolvability": 4
  },
  "issues": [
    {"priority": "P0", "issue": "缺少目录结构", "fixed": false},
    {"priority": "P1", "issue": "无版本信息", "fixed": true}
  ],
  "checksum": "abc123..."
}
```

下次评估时会对比历史：

```
📊 评估趋势

上次评估: 2024-12-20  65/100
本次评估: 2024-12-23  72/100

📈 提升 +7 分

已修复问题:
✅ 添加了技术栈说明
✅ 命令文档更完善

新发现问题:
⚠️ 代码规范章节变长了
```
