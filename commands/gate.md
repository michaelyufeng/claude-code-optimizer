---
description: Gate check - phase quality control before proceeding
---

# Gate 门控系统

阶段质量检查，必须通过才能进入下一阶段。

## 自动驾驶行为

Gate 检查由自动驾驶系统在每个阶段结束时自动触发。

---

## Gate 检查清单

### Gate 1: 研究阶段 → 规划阶段

```
🚧 Gate 1 检查

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 必须通过 (全部 ✅ 才能通过)

[ ] 需求分析完成
    - 项目目标明确
    - 目标用户定义
    - 核心需求列表

[ ] 技术方案已选定
    - 技术栈确定
    - 可行性已验证
    - 记录选型理由

[ ] CLAUDE.md 已更新
    - 技术栈章节
    - 技术约束章节

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

结果: [通过/不通过]
```

### Gate 2: 规划阶段 → 架构阶段

```
🚧 Gate 2 检查

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 必须通过 (全部 ✅ 才能通过)

[ ] PRD 文档完成
    - docs/PRD.md 已创建
    - 产品愿景明确
    - 目标用户描述

[ ] 功能规格明确
    - MVP 功能列表
    - 功能优先级 (P0/P1/P2)
    - 用户故事完整

[ ] CLAUDE.md 已更新
    - 核心功能章节
    - 开发优先级章节

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

结果: [通过/不通过]
```

### Gate 3: 架构阶段 → 开发阶段

```
🚧 Gate 3 检查

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 必须通过 (全部 ✅ 才能通过)

[ ] 系统架构完成
    - 架构风格确定
    - 组件职责明确
    - 架构图已绘制

[ ] API 设计完成
    - 端点列表完整
    - 请求/响应格式
    - 认证方案明确

[ ] 数据模型完成
    - 表结构设计
    - 字段定义
    - 关系图

[ ] 项目结构确定
    - 目录结构
    - 命名规范
    - 代码规范

[ ] 文档已生成
    - docs/ARCHITECTURE.md

[ ] CLAUDE.md 已更新
    - 架构规则章节
    - API 规范章节
    - 安全规则章节

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

结果: [通过/不通过]
```

---

## Gate 检查流程

### 自动检查

```markdown
## 自动检查项

1. 文件存在检查
   - 必要文档是否创建
   - CLAUDE.md 是否更新

2. 内容完整性检查
   - 必要章节是否存在
   - 关键信息是否填写

3. 一致性检查
   - CLAUDE.md 与文档一致
   - 状态正确更新
```

### 检查结果

```
🚧 Gate [N] 检查结果

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 检查项状态

✅ 需求分析完成
✅ 技术方案已选定
❌ CLAUDE.md 技术栈章节缺失

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

结果: ❌ 不通过

## 需要修复

1. CLAUDE.md 缺少技术栈章节
   建议添加:
   ```markdown
   ## 技术栈
   - 语言: [待填写]
   - 框架: [待填写]
   ```

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[1] 🔧 自动修复
[2] 📝 手动修复
[3] 🔄 重新检查
```

---

## 修复后重检

```
🔄 重新检查 Gate [N]

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 检查项状态

✅ 需求分析完成
✅ 技术方案已选定
✅ CLAUDE.md 技术栈章节 (已修复)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

结果: ✅ 通过！

正在进入下一阶段...
```

---

## 手动 Gate 检查

如需手动触发 Gate 检查:

```bash
/project-optimizer:gate           # 检查当前阶段
/project-optimizer:gate --all     # 检查所有阶段
/project-optimizer:gate --fix     # 检查并自动修复
```

---

## Gate 状态追踪

存储在 `.claude/PROJECT_STATE.json`:

```json
{
  "phases": {
    "research": {
      "status": "completed",
      "gate": {
        "passed": true,
        "checkedAt": "[timestamp]",
        "items": [
          { "name": "需求分析完成", "passed": true },
          { "name": "技术方案已选定", "passed": true },
          { "name": "CLAUDE.md 已更新", "passed": true }
        ]
      }
    },
    "plan": {
      "status": "completed",
      "gate": {
        "passed": true,
        "checkedAt": "[timestamp]"
      }
    },
    "arch": {
      "status": "in_progress",
      "gate": null
    },
    "dev": {
      "status": "pending",
      "gate": null
    }
  }
}
```
