---
description: Multi-agent system with automatic assignment
---

# 多 Agent 系统

根据任务类型自动分配最合适的 Agent。

## Agent 团队

### 🔬 分析师 (Analyst)

```yaml
角色: 需求分析、用户研究、技术调研
擅长:
  - 收集和整理信息
  - 竞品分析
  - 可行性评估
适用阶段: 研究
模型: Sonnet
```

### 📋 产品经理 (PM)

```yaml
角色: PRD 编写、需求优先级、路线图规划
擅长:
  - 编写产品需求文档
  - 用户故事定义
  - 功能优先级排序
适用阶段: 规划
模型: Sonnet
```

### 🏗️ 架构师 (Architect)

```yaml
角色: 系统设计、技术选型、API 设计
擅长:
  - 系统架构设计
  - API 设计
  - 数据模型设计
适用阶段: 架构
模型: Opus (关键决策)
```

### 💻 开发者 (Developer)

```yaml
角色: 代码实现、测试、优化
擅长:
  - 编写代码
  - 单元测试
  - Bug 修复
适用阶段: 开发
模型:
  - 简单任务: Haiku
  - 复杂任务: Sonnet
  - 架构级: Opus
```

### 👁️ 审核员 (Reviewer)

```yaml
角色: 代码审查、质量检查
擅长:
  - 代码审查
  - 安全审计
  - 质量检查
适用阶段: 开发 (每个功能完成后)
模型: Sonnet
```

### 🎯 协调者 (Orchestrator)

```yaml
角色: 流程协调、任务分配、进度跟踪
擅长:
  - 任务分配
  - 进度监控
  - 资源调度
适用: 全程
模型: Sonnet
```

---

## 自动分配规则

### 按阶段分配

| 阶段 | 主 Agent | 辅助 Agent |
|------|----------|------------|
| 研究 | 🔬 分析师 | - |
| 规划 | 📋 PM | 🔬 分析师 |
| 架构 | 🏗️ 架构师 | 📋 PM |
| 开发 | 💻 开发者 | 👁️ 审核员 |

### 按任务类型分配

| 任务类型 | Agent | 模型 |
|----------|-------|------|
| 需求分析 | 🔬 分析师 | Sonnet |
| 文档编写 | 📋 PM | Sonnet |
| 架构决策 | 🏗️ 架构师 | Opus |
| 简单实现 | 💻 开发者 | Haiku |
| 复杂实现 | 💻 开发者 | Sonnet |
| 代码审查 | 👁️ 审核员 | Sonnet |
| 安全审计 | 👁️ 审核员 | Opus |

### 按任务规模分配

| 规模 | 描述 | 模型 |
|------|------|------|
| S (小) | < 50 行代码 | Haiku |
| M (中) | 50-200 行 | Sonnet |
| L (大) | 200-500 行 | Sonnet |
| XL (超大) | > 500 行或跨模块 | Opus |

---

## Agent 切换显示

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔄 Agent 切换
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

从: 📋 PM (规划阶段)
到: 🏗️ 架构师 (架构阶段)

原因: 进入架构阶段，需要专业架构设计能力

🏗️ [架构师] 已激活

我将专注于:
- 系统架构设计
- API 设计
- 数据模型设计
- 技术方案评估

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 状态查看

```bash
/project-optimizer:agents           # 查看当前 Agent 状态
/project-optimizer:agents --list    # 查看所有 Agent
/project-optimizer:agents --history # 查看切换历史
```

### 输出示例

```
🤖 Agent 状态

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

当前阶段: 架构
活跃 Agent: 🏗️ 架构师 (Opus)

┌────────────┬──────────────┬────────────┬──────────┐
│ Agent      │ 角色         │ 当前阶段   │ 状态     │
├────────────┼──────────────┼────────────┼──────────┤
│ 🔬 分析师  │ 需求分析     │ ✓ 已完成   │ 休息     │
│ 📋 PM      │ PRD编写      │ ✓ 已完成   │ 休息     │
│ 🏗️ 架构师  │ 系统设计     │ ● 活跃     │ 工作中   │
│ 💻 开发者  │ 代码实现     │ ○ 未激活   │ 待命     │
│ 👁️ 审核员  │ 质量检查     │ ○ 未激活   │ 待命     │
│ 🎯 协调者  │ 流程协调     │ ● 活跃     │ 监控中   │
└────────────┴──────────────┴────────────┴──────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 配置存储

`.claude/PROJECT_STATE.json`:

```json
{
  "agents": {
    "active": "architect",
    "model": "opus",
    "history": [
      {
        "agent": "analyst",
        "phase": "research",
        "startedAt": "[timestamp]",
        "endedAt": "[timestamp]"
      },
      {
        "agent": "pm",
        "phase": "plan",
        "startedAt": "[timestamp]",
        "endedAt": "[timestamp]"
      },
      {
        "agent": "architect",
        "phase": "arch",
        "startedAt": "[timestamp]",
        "endedAt": null
      }
    ]
  }
}
```
