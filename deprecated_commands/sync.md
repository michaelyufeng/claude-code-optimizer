---
description: Synchronize CLAUDE.md and memory bank with current codebase state
---

# è®°å¿†åŒæ­¥ (Memory Sync)

## åŠŸèƒ½è¯´æ˜

è‡ªåŠ¨åŒæ­¥ CLAUDE.md å’Œé¡¹ç›®è®°å¿†ï¼Œç¡®ä¿æ–‡æ¡£ä¸ä»£ç å®ç°ä¿æŒä¸€è‡´ã€‚

çµæ„Ÿæ¥æºï¼š[my-claude-code-setup](https://github.com/centminmod/my-claude-code-setup)

## æ ¸å¿ƒæ¦‚å¿µ

### ä¸ºä»€ä¹ˆéœ€è¦åŒæ­¥ï¼Ÿ

```
é—®é¢˜ï¼šé¡¹ç›®æ¼”è¿›è¿‡ç¨‹ä¸­ï¼Œæ–‡æ¡£å®¹æ˜“è¿‡æ—¶

ä»£ç å˜åŒ–ï¼š
â”œâ”€â”€ æ–°å¢äº†ç›®å½• src/db/
â”œâ”€â”€ æ·»åŠ äº†ä¾èµ– drizzle-orm
â”œâ”€â”€ ä¿®æ”¹äº† API ç»“æ„
â””â”€â”€ è°ƒæ•´äº†é…ç½®æ–‡ä»¶

æ–‡æ¡£çŠ¶æ€ï¼š
â”œâ”€â”€ CLAUDE.md: æœªæ›´æ–° âŒ
â”œâ”€â”€ structure.md: è¿‡æ—¶ âŒ
â””â”€â”€ tech.md: ç¼ºå°‘æ–°ä¾èµ– âŒ

â†’ Claude åŸºäºè¿‡æ—¶ä¿¡æ¯å·¥ä½œ â†’ äº§ç”Ÿé”™è¯¯å»ºè®®
```

### åŒæ­¥æœºåˆ¶

```
åŒæ­¥æµç¨‹ï¼š

1. æ‰«æä»£ç å˜åŒ–
   â”œâ”€â”€ æ–°å¢æ–‡ä»¶/ç›®å½•
   â”œâ”€â”€ ä¾èµ–å˜åŒ–
   â””â”€â”€ é…ç½®å˜åŒ–

2. æ£€æµ‹æ–‡æ¡£å·®å¼‚
   â”œâ”€â”€ CLAUDE.md
   â”œâ”€â”€ steering/*.md
   â””â”€â”€ PROJECT_STATE.json

3. ç”Ÿæˆæ›´æ–°å»ºè®®
   â”œâ”€â”€ è‡ªåŠ¨æ›´æ–°
   â””â”€â”€ éœ€ç¡®è®¤æ›´æ–°

4. åº”ç”¨æ›´æ–°
   â””â”€â”€ è®°å½•å˜æ›´å†å²
```

---

## åŒæ­¥å‘½ä»¤

### æ£€æŸ¥åŒæ­¥çŠ¶æ€

```
/project-optimizer:sync --check
```

è¾“å‡ºï¼š

```
ğŸ“Š åŒæ­¥çŠ¶æ€æ£€æŸ¥

æ—¶é—´: 2024-12-15 14:30
ä¸Šæ¬¡åŒæ­¥: 2024-12-14 10:00 (28h ago)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## æ£€æµ‹åˆ°çš„å˜åŒ–

### ğŸ“ æ–‡ä»¶ç»“æ„å˜åŒ–
+ æ–°å¢ç›®å½•: src/db/
+ æ–°å¢ç›®å½•: src/db/migrations/
+ æ–°å¢æ–‡ä»¶: src/db/schema.ts
- åˆ é™¤æ–‡ä»¶: src/utils/deprecated.ts

### ğŸ“¦ ä¾èµ–å˜åŒ–
+ æ–°å¢: drizzle-orm@0.29.0
+ æ–°å¢: drizzle-kit@0.20.0
~ æ›´æ–°: typescript@5.2.0 â†’ 5.3.0

### âš™ï¸ é…ç½®å˜åŒ–
~ ä¿®æ”¹: tsconfig.json (æ·»åŠ è·¯å¾„åˆ«å)
+ æ–°å¢: drizzle.config.ts

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## æ–‡æ¡£åŒæ­¥çŠ¶æ€

| æ–‡æ¡£ | çŠ¶æ€ | å·®å¼‚é¡¹ |
|------|------|--------|
| CLAUDE.md | âš ï¸ è¿‡æ—¶ | 3 é¡¹ |
| steering/structure.md | âš ï¸ è¿‡æ—¶ | 2 é¡¹ |
| steering/tech.md | âš ï¸ è¿‡æ—¶ | 3 é¡¹ |
| steering/product.md | âœ… åŒæ­¥ | 0 é¡¹ |

æ€»è®¡: 8 é¡¹éœ€è¦æ›´æ–°

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

è¿è¡Œ /project-optimizer:sync æ‰§è¡ŒåŒæ­¥
```

---

### æ‰§è¡ŒåŒæ­¥

```
/project-optimizer:sync
```

è¾“å‡ºï¼š

```
ğŸ”„ æ‰§è¡Œè®°å¿†åŒæ­¥

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## è‡ªåŠ¨æ›´æ–° (5 é¡¹)

### steering/structure.md
+ æ·»åŠ ç›®å½•: src/db/
+ æ·»åŠ ç›®å½•: src/db/migrations/

### steering/tech.md
+ æ·»åŠ ä¾èµ–: drizzle-orm@0.29.0
+ æ·»åŠ ä¾èµ–: drizzle-kit@0.20.0
~ æ›´æ–°ç‰ˆæœ¬: typescript@5.3.0

âœ… è‡ªåŠ¨æ›´æ–°å®Œæˆ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

## éœ€è¦ç¡®è®¤ (3 é¡¹)

### [1] CLAUDE.md - æŠ€æœ¯æ ˆéƒ¨åˆ†
å½“å‰:
> æ•°æ®åº“: SQLite

å»ºè®®æ›´æ–°ä¸º:
> æ•°æ®åº“: SQLite + Drizzle ORM

ç¡®è®¤æ›´æ–°ï¼Ÿ [Y/n/e(ç¼–è¾‘)]

### [2] CLAUDE.md - é¡¹ç›®ç»“æ„éƒ¨åˆ†
å»ºè®®æ·»åŠ :
```
src/
â””â”€â”€ db/           # æ•°æ®åº“å±‚ (Drizzle)
    â”œâ”€â”€ schema.ts # æ•°æ®æ¨¡å‹
    â””â”€â”€ migrations/
```

ç¡®è®¤æ›´æ–°ï¼Ÿ [Y/n/e(ç¼–è¾‘)]

### [3] è§„åˆ™æ›´æ–°
æ£€æµ‹åˆ°æ–°çš„æ•°æ®åº“å±‚ï¼Œå»ºè®®æ·»åŠ è§„åˆ™ï¼š

{
  "id": "db-drizzle",
  "level": "SHOULD",
  "value": "ä½¿ç”¨ Drizzle ORM è¿›è¡Œæ•°æ®åº“æ“ä½œ"
}

ç¡®è®¤æ·»åŠ ï¼Ÿ [Y/n]
```

---

### æ™ºèƒ½åŒæ­¥

```
/project-optimizer:sync --smart
```

æ™ºèƒ½æ¨¡å¼ä¼šï¼š
1. è‡ªåŠ¨åº”ç”¨ä½é£é™©æ›´æ–°
2. ä»…è¯¢é—®å¯èƒ½å½±å“å·¥ä½œæµçš„å˜æ›´
3. ç”ŸæˆåŒæ­¥æ‘˜è¦

```
ğŸ§  æ™ºèƒ½åŒæ­¥å®Œæˆ

è‡ªåŠ¨æ›´æ–°: 5 é¡¹
è·³è¿‡ç¡®è®¤: 2 é¡¹ (ä½é£é™©)
éœ€è¦ç¡®è®¤: 1 é¡¹

ğŸ“‹ æ‘˜è¦:
- ç»“æ„æ–‡æ¡£å·²æ›´æ–°ï¼Œåæ˜  db/ ç›®å½•
- æŠ€æœ¯æ–‡æ¡£å·²æ›´æ–°ï¼ŒåŒ…å« Drizzle ä¾èµ–
- å¾…ç¡®è®¤ï¼šæ˜¯å¦å°† Drizzle æ·»åŠ ä¸ºå¼ºåˆ¶è§„åˆ™

è¿è¡Œ /project-optimizer:sync --pending æŸ¥çœ‹å¾…ç¡®è®¤é¡¹
```

---

## åŒæ­¥èŒƒå›´

### åŒæ­¥çš„å†…å®¹

```markdown
## è‡ªåŠ¨åŒæ­¥

### æ–‡ä»¶ç»“æ„
- ç›®å½•æ ‘å˜åŒ–
- å…³é”®æ–‡ä»¶æ·»åŠ /åˆ é™¤
- æ¨¡å—ç»„ç»‡å˜åŒ–

### ä¾èµ–
- package.json å˜åŒ–
- ç‰ˆæœ¬æ›´æ–°
- æ–°å¢/ç§»é™¤ä¾èµ–

### é…ç½®
- tsconfig.json
- ç¯å¢ƒé…ç½®
- å·¥å…·é…ç½®

## éœ€ç¡®è®¤åŒæ­¥

### CLAUDE.md æ ¸å¿ƒå†…å®¹
- æŠ€æœ¯æ ˆæè¿°
- æ¶æ„æè¿°
- è§„åˆ™å˜æ›´

### Steering æ–‡æ¡£
- product.md åŠŸèƒ½æè¿°
- é‡å¤§æŠ€æœ¯å†³ç­–
```

### ä¸åŒæ­¥çš„å†…å®¹

```markdown
## æ’é™¤é¡¹

- node_modules/
- .git/
- æ„å»ºè¾“å‡º (dist/, build/)
- ä¸´æ—¶æ–‡ä»¶
- æµ‹è¯•å¿«ç…§
```

---

## å†²çªå¤„ç†

### æ£€æµ‹åˆ°å†²çª

```
âš ï¸ åŒæ­¥å†²çª

æ–‡ä»¶: CLAUDE.md

æœ¬åœ°ç‰ˆæœ¬ (æ‰‹åŠ¨ç¼–è¾‘):
```markdown
## æŠ€æœ¯æ ˆ
- æ¡†æ¶: Next.js 14
- æ ·å¼: Tailwind CSS
```

ä»£ç åº“ç‰ˆæœ¬ (è‡ªåŠ¨æ£€æµ‹):
```markdown
## æŠ€æœ¯æ ˆ
- æ¡†æ¶: Next.js 15 (æ£€æµ‹åˆ°æ›´æ–°)
- æ ·å¼: Tailwind CSS
- æ–°å¢: Shadcn UI (æ£€æµ‹åˆ°ä½¿ç”¨)
```

é€‰æ‹©:
[1] ä½¿ç”¨æœ¬åœ°ç‰ˆæœ¬ (å¿½ç•¥æ£€æµ‹)
[2] ä½¿ç”¨ä»£ç åº“ç‰ˆæœ¬ (è¦†ç›–æœ¬åœ°)
[3] åˆå¹¶ (æ‰‹åŠ¨ç¼–è¾‘)
[4] æŸ¥çœ‹è¯¦ç»†å·®å¼‚
```

---

## åŒæ­¥å†å²

### æŸ¥çœ‹å†å²

```
/project-optimizer:sync --history
```

è¾“å‡ºï¼š

```
ğŸ“‹ åŒæ­¥å†å²

| æ—¶é—´ | ç±»å‹ | å˜æ›´æ•° | æ“ä½œ |
|------|------|--------|------|
| 12-15 14:30 | è‡ªåŠ¨ | 5 | ç»“æ„+ä¾èµ–æ›´æ–° |
| 12-14 10:00 | æ‰‹åŠ¨ | 3 | è§„åˆ™æ›´æ–° |
| 12-13 16:00 | è‡ªåŠ¨ | 2 | ä¾èµ–æ›´æ–° |
| 12-12 09:00 | åˆå§‹åŒ– | - | é¦–æ¬¡åŒæ­¥ |

æŸ¥çœ‹è¯¦æƒ…: /project-optimizer:sync --history [æ—¥æœŸ]
```

---

## è‡ªåŠ¨åŒæ­¥

### è§¦å‘æ¡ä»¶

```markdown
è‡ªåŠ¨åŒæ­¥åœ¨ä»¥ä¸‹æƒ…å†µè§¦å‘ï¼š

1. **ä¼šè¯å¼€å§‹æ—¶**
   - æ£€æŸ¥ä¸Šæ¬¡åŒæ­¥æ—¶é—´
   - å¦‚æœ > 24hï¼Œæç¤ºåŒæ­¥

2. **é˜¶æ®µå®Œæˆæ—¶**
   - ç ”ç©¶/è§„åˆ’/æ¶æ„é˜¶æ®µå®Œæˆ
   - è‡ªåŠ¨æ›´æ–°ç›¸å…³æ–‡æ¡£

3. **Git æ“ä½œå**
   - merge/rebase å
   - æ‹‰å–è¿œç¨‹æ›´æ–°å

4. **ä¾èµ–æ›´æ–°å**
   - npm install å
   - æ£€æµ‹ package.json å˜åŒ–
```

### é…ç½®è‡ªåŠ¨åŒæ­¥

`.claude/PROJECT_MEMORY/sync-config.json`:

```json
{
  "autoSync": {
    "enabled": true,
    "interval": "24h",
    "onPhaseComplete": true,
    "onGitPull": true,
    "onDependencyChange": true
  },
  "confirmThreshold": "medium",
  "excludePatterns": [
    "*.test.ts",
    "*.spec.ts",
    "__tests__/**"
  ]
}
```

---

## å‘½ä»¤æ±‡æ€»

```bash
/project-optimizer:sync              # æ‰§è¡ŒåŒæ­¥
/project-optimizer:sync --check      # ä»…æ£€æŸ¥çŠ¶æ€
/project-optimizer:sync --smart      # æ™ºèƒ½åŒæ­¥
/project-optimizer:sync --force      # å¼ºåˆ¶å…¨é‡åŒæ­¥
/project-optimizer:sync --history    # æŸ¥çœ‹åŒæ­¥å†å²
/project-optimizer:sync --pending    # æŸ¥çœ‹å¾…ç¡®è®¤é¡¹
/project-optimizer:sync --diff       # æŸ¥çœ‹è¯¦ç»†å·®å¼‚
```
