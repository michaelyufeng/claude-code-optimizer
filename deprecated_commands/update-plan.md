---
description: Update development plan for existing projects
---

# 更新计划 (开发中项目 - Phase 2/5)

## 前置检查

确认分析阶段 (`analyze`) 已完成。

## 计划更新任务

基于分析结果，更新开发计划。

### 📋 1. 功能优先级排序

```markdown
## 功能优先级

根据分析结果，对待完成功能进行优先级排序：

### P0 - 必须完成 (MVP)
| ID | 功能 | 当前状态 | 预估工作量 | 依赖 |
|----|------|----------|------------|------|
| F1 | | | | |
| F2 | | | | |

### P1 - 应该完成 (第一版)
| ID | 功能 | 当前状态 | 预估工作量 | 依赖 |
|----|------|----------|------------|------|
| F3 | | | | |

### P2 - 可以完成 (后续迭代)
| ID | 功能 | 当前状态 | 预估工作量 | 依赖 |
|----|------|----------|------------|------|
| F4 | | | | |
```

### 🐛 2. 问题修复计划

```markdown
## 问题修复计划

### 紧急修复 (阻塞开发)
| ID | 问题 | 影响范围 | 修复方案 |
|----|------|----------|----------|
| | | | |

### 高优先级 (影响质量)
| ID | 问题 | 影响范围 | 修复方案 |
|----|------|----------|----------|
| | | | |

### 低优先级 (技术债务)
| ID | 问题 | 影响范围 | 处理策略 |
|----|------|----------|----------|
| | | | |
```

### 🔄 3. 重构建议

```markdown
## 重构建议

### 建议重构的模块
| 模块 | 原因 | 优先级 | 方案 |
|------|------|--------|------|
| | | | |

### 架构优化
- [优化点1]
- [优化点2]

### 代码规范统一
- [需要统一的规范]
```

### 📅 4. 迭代计划

```markdown
## 迭代计划

### Sprint 1: [名称]
目标: [目标描述]
功能:
- [ ] F1 - [描述]
- [ ] F2 - [描述]
问题修复:
- [ ] Bug1
验收标准:
- [ ] [标准1]

### Sprint 2: [名称]
目标: [目标描述]
功能:
- [ ] F3 - [描述]
问题修复:
- [ ] Bug2
验收标准:
- [ ] [标准1]
```

### ⚠️ 5. 保护规则

```markdown
## 保护规则

### 不应修改的文件
- [file1] - 原因: [原因]
- [file2] - 原因: [原因]

### 不应删除的功能
- [feature1] - 原因: [原因]

### 必须保持的接口
- [API1] - 被 [X] 个地方依赖
- [API2] - 被 [X] 个地方依赖

### 必须通过的测试
- [测试文件/套件]
```

---

## 输出产物

生成/更新以下文件：

1. `docs/DEV_PLAN.md` - 开发计划
2. `.claude/PROTECTED.json` - 保护规则配置

更新 `PROJECT_STATE.json`:
```json
{
  "phases": {
    "update-plan": { "status": "completed", "completedAt": "[timestamp]" },
    "gate1": { "status": "in_progress" }
  },
  "plan": {
    "sprints": [],
    "prioritizedFeatures": [],
    "protectedFiles": []
  }
}
```

输出：
```
✅ 开发计划更新完成！

📋 计划摘要：
- P0 功能: X 个
- P1 功能: X 个
- 待修复问题: X 个
- 计划迭代: X 个

⚠️ 保护规则已设置：
- 保护文件: X 个
- 保护接口: X 个

📄 开发计划: docs/DEV_PLAN.md

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔧 开发中项目流程:
✓ 分析 → ✓ 更新计划 → 🚧 Gate → 💻 继续开发 → 📦 输出
                         ↑
                       下一步
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

下一步：运行 /project-optimizer:gate1 进行计划审核
```
